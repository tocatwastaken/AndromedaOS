--Sourced from https://raw.githubusercontent.com/MaHuJa/CC-scripts/refs/heads/master/sha256.lua, slightly altered to be require-able
local a={}a.__index=a;local b=2^32;local c=b-1;local function d(e)local f={}local g=setmetatable({},f)function f:__index(h)local i=e(h)g[h]=i;return i end;return g end;local function j(g,k)local function l(m,n)local o,p=0,1;while m~=0 and n~=0 do local q,r=m%k,n%k;o=o+g[q][r]*p;m=(m-q)/k;n=(n-r)/k;p=p*k end;o=o+(m+n)*p;return o end;return l end;local function s(g)local t=j(g,2^1)local u=d(function(m)return d(function(n)return t(m,n)end)end)return j(u,2^(g.n or 1))end;local v=s({[0]={[0]=0,[1]=1},[1]={[0]=1,[1]=0},n=4})local function w(m,n,x,...)local y=nil;if n then m=m%b;n=n%b;y=v(m,n)if x then y=w(y,x,...)end;return y elseif m then return m%b else return 0 end end;local function z(m,n,x,...)local y;if n then m=m%b;n=n%b;y=(m+n-v(m,n))/2;if x then y=bit32_band(y,x,...)end;return y elseif m then return m%b else return c end end;local function A(B)return(-1-B)%b end;local function C(m,D)if D<0 then return lshift(m,-D)end;return math.floor(m%2^32/2^D)end;local function E(B,D)if D>31 or D<-31 then return 0 end;return C(B%b,D)end;local function lshift(m,D)if D<0 then return E(m,-D)end;return m*2^D%2^32 end;local function F(B,D)B=B%b;D=D%32;local G=z(B,2^D-1)return E(B,D)+lshift(G,32-D)end;local h={0x428a2f98,0x71374491,0xb5c0fbcf,0xe9b5dba5,0x3956c25b,0x59f111f1,0x923f82a4,0xab1c5ed5,0xd807aa98,0x12835b01,0x243185be,0x550c7dc3,0x72be5d74,0x80deb1fe,0x9bdc06a7,0xc19bf174,0xe49b69c1,0xefbe4786,0x0fc19dc6,0x240ca1cc,0x2de92c6f,0x4a7484aa,0x5cb0a9dc,0x76f988da,0x983e5152,0xa831c66d,0xb00327c8,0xbf597fc7,0xc6e00bf3,0xd5a79147,0x06ca6351,0x14292967,0x27b70a85,0x2e1b2138,0x4d2c6dfc,0x53380d13,0x650a7354,0x766a0abb,0x81c2c92e,0x92722c85,0xa2bfe8a1,0xa81a664b,0xc24b8b70,0xc76c51a3,0xd192e819,0xd6990624,0xf40e3585,0x106aa070,0x19a4c116,0x1e376c08,0x2748774c,0x34b0bcb5,0x391c0cb3,0x4ed8aa4a,0x5b9cca4f,0x682e6ff3,0x748f82ee,0x78a5636f,0x84c87814,0x8cc70208,0x90befffa,0xa4506ceb,0xbef9a3f7,0xc67178f2}local function H(I)return string.gsub(I,".",function(x)return string.format("%02x",string.byte(x))end)end;local function J(K,L)local I=""for M=1,L do local N=K%256;I=string.char(N)..I;K=(K-N)/256 end;return I end;local function O(I,M)local L=0;for M=M,M+3 do L=L*256+string.byte(I,M)end;return L end;local function P(Q,R)local S=64-(R+9)%64;R=J(8*R,8)Q=Q.."\128"..string.rep("\0",S)..R;assert(#Q%64==0)return Q end;local function T(U)U[1]=0x6a09e667;U[2]=0xbb67ae85;U[3]=0x3c6ef372;U[4]=0xa54ff53a;U[5]=0x510e527f;U[6]=0x9b05688c;U[7]=0x1f83d9ab;U[8]=0x5be0cd19;return U end;local function V(Q,M,U)local W={}for X=1,16 do W[X]=O(Q,M+(X-1)*4)end;for X=17,64 do local i=W[X-15]local Y=w(F(i,7),F(i,18),E(i,3))i=W[X-2]W[X]=W[X-16]+Y+W[X-7]+w(F(i,17),F(i,19),E(i,10))end;local m,n,x,Z,_,e,a0,a1=U[1],U[2],U[3],U[4],U[5],U[6],U[7],U[8]for M=1,64 do local Y=w(F(m,2),F(m,13),F(m,22))local a2=w(z(m,n),z(m,x),z(n,x))local a3=Y+a2;local a4=w(F(_,6),F(_,11),F(_,25))local a5=w(z(_,e),z(A(_),a0))local a6=a1+a4+a5+h[M]+W[M]a1,a0,e,_,Z,x,n,m=a0,e,_,Z+a6,x,n,m,a6+a3 end;U[1]=z(U[1]+m)U[2]=z(U[2]+n)U[3]=z(U[3]+x)U[4]=z(U[4]+Z)U[5]=z(U[5]+_)U[6]=z(U[6]+e)U[7]=z(U[7]+a0)U[8]=z(U[8]+a1)end;function a:sha256(Q)Q=P(Q,#Q)local U=T({})for M=1,#Q,64 do V(Q,M,U)end;return H(J(U[1],4)..J(U[2],4)..J(U[3],4)..J(U[4],4)..J(U[5],4)..J(U[6],4)..J(U[7],4)..J(U[8],4))end;return a